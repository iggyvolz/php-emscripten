<!DOCTYPE HTML>
<html>

<head>
    <script>
        let html = true;
        const stdoutCallback = (data) => {
            const str = Array.from(data).map(x => String.fromCharCode(x)).join('')

            if(html) {
                document.getElementById("outputHtml").contentWindow.document.write(str);
            } else {
                document.getElementById("output").value += str;
            }
        }
    </script>
    <!-- <script src="php.js"></script> -->
    <script>
        const myWorker = new Worker("worker.js");
        myWorker.postMessage("echo 1;");

        myWorker.onmessage = e => {
            console.log({line: 22, e});
        }

        window.submit = async () => {
            // Clear old output
            output = "";
            document.getElementById('output').value='';
            document.getElementById('outputHtml').src='';
            // await php(document.getElementById("input").value)
        }
    </script>
</head>

<body>
    <textarea id="input">phpinfo();</textarea>
    <button onclick="submit()">Submit</button>
    <label><input type="radio" name="type" onclick="html=false;document.querySelector('#output').style.display='block';document.querySelector('#outputHtml').style.display='none';">Text</label>
    <label><input type="radio" name="type" checked onclick="html=true;document.querySelector('#outputHtml').style.display='block';document.querySelector('#output').style.display='none';">HTML</label>
    <br>
    <textarea id="output" readonly style="display:none;width: 95vw; height:75vh;"></textarea>
    <iframe id="outputHtml" style="width: 95vw; height:75vh;"></iframe>
    <script>submit(); // submit first time</script>
</body>

</html>